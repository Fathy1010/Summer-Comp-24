<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Add an animated icon to the map</title>
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.js"></script>
  <script src="https://kit.fontawesome.com/a2ecfaf3c8.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    integrity="sha384-Zk2KpMtxpB6mbwPZLddv1G5ndZ1GwA1iHMzL8Ojib4kp4A9k9GiRVFMM4MNhP2Z9" crossorigin="anonymous">
  <!-- Load the `mapbox-gl-geocoder` plugin. -->
  <script
    src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js"></script>
  <link rel="stylesheet"
    href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css" type="text/css">

  <script
    src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.2.0/mapbox-gl-directions.js"></script>
  <link rel="stylesheet"
    href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.2.0/mapbox-gl-directions.css"
    type="text/css">

  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }

    #place {
      position: absolute;
      bottom: 20px;
      right: 20px;
      width: 50px;
      /* Adjust the width as needed */
      height: 50px;
      border: none;
      border-radius: 50%;
      background: #2281e8;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    #place img {
      width: 80%;
      /* Adjust the size of the icon */
      height: auto;
    }

    #fly {
      position: absolute;
      bottom: 75px;
      /* Adjust the distance from the bottom */
      right: 20px;
      width: 50px;
      /* Adjust the width as needed */
      height: 50px;
      border: none;
      border-radius: 3px;
      font-size: 12px;
      text-align: center;
      background: #2281e8;
    }

    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    #overlay {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 1000;
      background-color: #2281e8;
      padding: 5px;
      border-radius: 5px;
    }

    .marker {
      display: block;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      padding: 0;
    }
  </style>
</head>

<body>
  <div id="map"></div>

  <button id="place" onclick="getLocation()">
    <img src="img/GPS-PhotoRoom.png" width="20" height="20">
  </button>

  <button id="fly"> <img src="img/Diocese-PhotoRoom.png" width="40.5" height="40.5"></button>

  <button id="overlay" href="homePage.html" type="button" onclick="moveToHome()"> <i
      class="fa-solid fa-arrow-left-long"></i> Back </button>

  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiZmF0aHktYSIsImEiOiJjbHJ6d3Q5dHcxa3dtMnFvNXQzaWt4Z3BrIn0.havexQQgUtpVfdiZYPaoKw';
    const map = new mapboxgl.Map({
      container: 'map',
      center: [0, 0],
      zoom: 2,
      // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
      style: 'mapbox://styles/mapbox/satellite-streets-v12'
    });

    const size = 200;
    // This implements `StyleImageInterface`
    // to draw a pulsing dot icon on the map.
    const pulsingDot = {
      width: size,
      height: size,
      data: new Uint8Array(size * size * 4),

      // When the layer is added to the map,
      // get the rendering context for the map canvas.
      onAdd: function () {
        const canvas = document.createElement('canvas');
        canvas.width = this.width;
        canvas.height = this.height;
        this.context = canvas.getContext('2d');
      },

      // Call once before every frame where the icon will be used.
      render: function () {
        const duration = 1000;
        const t = (performance.now() % duration) / duration;

        const radius = (size / 4) * 0.3;
        const outerRadius = (size / 4) * 0.7 * t + radius;
        const context = this.context;

        // Draw the outer circle.
        context.clearRect(0, 0, this.width, this.height);
        context.beginPath();
        context.arc(
          this.width / 4,
          this.height / 4,
          outerRadius,
          0,
          Math.PI * 2
        );
        context.fillStyle = `rgba(255, 200, 200, ${1 - t})`;
        context.fill();

        // Draw the inner circle.
        context.beginPath();
        context.arc(
          this.width / 4,
          this.height / 4,
          radius,
          0,
          Math.PI * 2
        );
        context.fillStyle = 'rgba(255, 100, 100, 1)';
        context.strokeStyle = 'white';
        context.lineWidth = 2 + 4 * (1 - t);
        context.fill();
        context.stroke();

        // Update this image's data with data from the canvas.
        this.data = context.getImageData(
          0,
          0,
          this.width,
          this.height
        ).data;

        // Continuously repaint the map, resulting
        // in the smooth animation of the dot.
        map.triggerRepaint();

        // Return `true` to let the map know that the image was updated.
        return true;
      }
    };

    function getLocation() {
      let x = document.getElementById("place");
      // if the browser allows gbs to be accesed
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
      } else {
        x.innerHTML = "Geolocation is not supported by this browser.";
      }
    };
    locationsGps = []
    function showPosition(position) {
      let marker = new mapboxgl.Marker({ color: "3370FF" });
      let location = {
        current: [position.coords.longitude, position.coords.latitude],
        description: "Your Position",
      };
      map.panTo(location.current)
      marker.setLngLat(location.current);
      let popup = new mapboxgl.Popup({ offset: 45 });
      popup.setText(location.description);
      marker.setPopup(popup);
      marker.addTo(map);
      // Display the popup.
      popup.addTo(map);
      map.addImage('pulsing-dot', pulsingDot, { pixelRatio: 2 });
      map.addSource('dot-point', {
        'type': 'geojson',
        'data': {
          'type': 'FeatureCollection',
          'features': [
            {
              'type': 'Feature',
              'geometry': {
                'type': 'Point',
                'coordinates': location.current // icon position [lng, lat]
              }
            }
          ]
        }
      });
      map.addLayer({
        'id': 'layer-with-pulsing-dot',
        'type': 'symbol',
        'source': 'dot-point',
        'layout': {
          'icon-image': 'pulsing-dot'
        }
      }).addTo(map);
      map.panTo(location.current);

    };
    // if needed to remove layers
    function removeLayerWithId(idToRemove) {
      let hasPoly = map.getLayer(idToRemove);
      if (hasPoly !== undefined) {
        map.removeLayer(idToRemove);
        map.removeSource(idToRemove);
      }
    }
    // button to get the pan to the coptic diocese of melb
    document.getElementById('fly').addEventListener('click', () => {
      // Fly to a random location
      map.flyTo({
        center: [144.9441008, -37.8010007],
        essential: true, // this animation is considered essential with respect to prefers-reduced-motion
        zoom: 10
      });
    });
    // the directional nav system w satellite feedback
    map.addControl(
      new MapboxDirections({
        accessToken: mapboxgl.accessToken
      }),
      'top-right'
    );
    // adding the zoon in and out functionality
    map.addControl(new mapboxgl.NavigationControl());



    // these are for the icons and marks to be placed on the map
    const geojson = {
      'type': 'FeatureCollection',
      'features': [
        {
          'type': 'Feature',
          'properties': {
            'message': 'St.George',
            'iconSize': [60, 60]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.79872, -37.73440]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St.Mary',
            'iconSize': [55, 55]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.92728, -37.79408]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St.Mark',
            'iconSize': [55, 55]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.988420, -37.749540]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Verena & St Bishoy',
            'iconSize': [50, 50]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.960810, -37.810710]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St John & St Verena',
            'iconSize': [50, 50]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [145.011580, -37.852690]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Macarius',
            'iconSize': [60, 60]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [145.133239, -37.633899]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Athanasius',
            'iconSize': [65, 60]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [145.197356, -37.796850]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'Archangel Michael & St Anthony',
            'iconSize': [66, 60]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [145.090532, -37.896638]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Bishoy and St Shenouda',
            'iconSize': [50, 50]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [145.094765, -37.775792]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Mina and St Marina',
            'iconSize': [40, 40]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [145.285377, -38.004752]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Anthony Monastry',
            'iconSize': [40, 40]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.792127, -36.927455]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'Archangel Michael Monastry',
            'iconSize': [40, 40]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.558842, -37.322941]
          }
        }
        ,
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Paul',
            'iconSize': [40, 40]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.28144,-36.74552]
          }
        }
        ,
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Philopateer',
            'iconSize': [50, 50]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.583980, -37.689370]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Karas & St Severus',
            'iconSize': [40, 40]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [145.482270, -38.076680]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Moses',
            'iconSize': [40, 40]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.354730, -38.151530]
          }
        },
        {
          'type': 'Feature',
          'properties': {
            'message': 'St Pope Kyrillos VI',
            'iconSize': [40, 40]
          },
          'geometry': {
            'type': 'Point',
            'coordinates': [144.523860, -37.366950]
          }
        }
      ]
    };

    // Add markers to the map.
    for (const marker of geojson.features) {
      // Create a DOM element for each marker.
      const el = document.createElement('div');
      const width = marker.properties.iconSize[0];
      const height = marker.properties.iconSize[1];
      el.className = 'marker';
      if (marker.properties.message == 'St.George') {
        el.style.backgroundImage = `url(https://i0.wp.com/stgeorgecopts.org.au/wp-content/uploads/2018/11/logo.png?fit=101%2C100&ssl=1/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stgeorge.html';
          }
        });
      }
      if (marker.properties.message == 'St.Mary') {
        el.style.backgroundImage = `url(https://images.squarespace-cdn.com/content/v1/5e7153f21603ee1f241f93de/1586580457079-K85WFDV3DO3LN8F5D094/St+Mary+Logo+v2+white+background+and+border.png?format=1500w/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stmary.html';
          }
        });
      }
      if (marker.properties.message == 'St.Mark') {
        el.style.backgroundImage = `url(https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSEHPK77gIlz8M6KAqPH-sAmCDgxL6AlJyh3w&usqp=CAU/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stmark.html';
          }
        });
      }
      if (marker.properties.message == 'St Verena & St Bishoy') {
        el.style.backgroundImage = `url(https://i.imgur.com/DImum81.png/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stverenabishoy.html';
          }
        });
      }
      if (marker.properties.message == 'St John & St Verena') {
        el.style.backgroundImage = `url(https://i.imgur.com/71nx4ik.png/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stjohnverena.html';
          }
        });
      }
      if (marker.properties.message == 'St Macarius') {
        el.style.backgroundImage = `url(https://i.imgur.com/CgpH7nL.jpeg/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stmacarius.html';
          }
        });
      }
      if (marker.properties.message == 'St Athanasius') {
        el.style.backgroundImage = `url(https://images.squarespace-cdn.com/content/v1/60acee37929085620645fe23/7eec048f-307d-4d1d-aa38-89f944a5992e/IMG_0351.PNG?format=1500w/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stathanasius.html';
          }
        });
      }
      if (marker.properties.message == 'Archangel Michael & St Anthony') {
        el.style.backgroundImage = `url(https://i.imgur.com/4cqbRQQ.png/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'archangelmichaelstanthony.html';
          }
        });
      }
      if (marker.properties.message == 'St Bishoy and St Shenouda') {
        el.style.backgroundImage = `url(https://i.imgur.com/SIeyMyp.jpeg/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stbishoyshenouda.html';
          }
        });
      }
      if (marker.properties.message == 'St Mina and St Marina') {
        el.style.backgroundImage = `url(https://i.imgur.com/bJGUjMs.jpeg/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stminamarina.html';
          }
        });
      }
      if (marker.properties.message == 'St Anthony Monastry') {
        el.style.backgroundImage = `url(https://i.imgur.com/VZqap6K.jpeg/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'stanthonymon.html';
          }
        });
      }
      if (marker.properties.message == 'Archangel Michael Monastry') {
        el.style.backgroundImage = `url(https://i.imgur.com/FcAIzj9.jpeg/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = 'archangelmichaelnun.html';
          }
        });
      }
      if (marker.properties.message == 'St Paul') {
        el.style.backgroundImage = `url(https://i.imgur.com/OzF77Xv.png/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = '.html';
          }
        });
      }
      if (marker.properties.message == 'St Philopateer') {
        el.style.backgroundImage = `url(https://i.imgur.com/Kb7mKcw.png/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = '.html';
          }
        });
      }
      if (marker.properties.message == 'St Karas & St Severus') {
        el.style.backgroundImage = `url(https://i.imgur.com/PiEQWZm.jpeg/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = '.html';
          }
        });
      }
      if (marker.properties.message == 'St Moses') {
        el.style.backgroundImage = `url(https://i.imgur.com/PQkJpGo.png/g/${width}/${height}/)`;
        // Add a click event listener to the marker element
        el.addEventListener('click', function () {
          // Ask for confirmation
          const userConfirmation = confirm(`Would you like to go to a new page related to ${marker.properties.message}?`);

          // If user confirms, redirect to a new page
          if (userConfirmation) {
            // Replace 'your_new_page_url' with the actual URL you want to redirect to
            window.location.href = '.html';
          }
        });
      }


      el.style.width = `${width}px`;
      el.style.height = `${height}px`;
      el.style.backgroundSize = '100%';

      // Add markers to the map.
      new mapboxgl.Marker(el)
        .setLngLat(marker.geometry.coordinates)
        .addTo(map);
    }

  </script>
  <script src="Js/homePage.js"></script>
  <script src="Js/shared.js"></script>
</body>

</html>